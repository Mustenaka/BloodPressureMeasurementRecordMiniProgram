"use strict";var e=require("../../common/vendor.js");const o={data:()=>({swiperList:["../../static/swiper/swiper2.png"]}),created(){console.log("create触发"),this.tester()},methods:{login(){e.index.getUserProfile({desc:"微信快捷登录",success:o=>{console.log("用户信息: "+JSON.stringify(o.userInfo));let i=o.userInfo;e.index.login({provider:"weixin",success:o=>{e.index.showLoading({title:"登陆中"});var n=o.code;console.log("用户code获取:"+JSON.stringify(o)),console.log("UserInfo:",JSON.stringify(i)),e.index.request({url:"http://1.117.222.119/wxlogin",method:"POST",header:{"content-type":"application/json"},data:{code:n},success:o=>{if(console.log("登陆:"+JSON.stringify(o.data)),0==o.data.err_code){var i=o.data.data.token;e.index.setStorageSync("token",i),console.log("Token:"+i),e.index.hideLoading(),e.index.switchTab({url:"/pages/index/index",animationType:"pop-in",animationDuration:200})}else 40003==o.data.err_code?(e.index.hideLoading(),e.index.showToast({title:"登陆失败-请先注册",icon:"none"})):(e.index.hideLoading(),e.index.showToast({title:"登陆失败-可能是网络问题",icon:"none"}))},fail:o=>{e.index.hideLoading(),e.index.showToast({title:"登陆失败",icon:"none"})}})}})}})},register(){e.index.getUserProfile({desc:"第一次使用自动注册",success:o=>{console.log("用户信息: "+JSON.stringify(o.userInfo));let i=o.userInfo;e.index.login({provider:"weixin",success:o=>{e.index.showLoading({title:"注册中"});var n=o.code;console.log("用户code获取成功:"+JSON.stringify(o)),console.log("UserInfo:",JSON.stringify(i)),e.index.request({url:"http://1.117.222.119/wxregister",method:"POST",header:{"content-type":"application/json"},data:{code:n,username:i.nickName,sex:0==i.gender?"男":"女",avatarUrl:i.avatarUrl},success:o=>{console.log("注册:"+JSON.stringify(o.data)),e.index.hideLoading(),e.index.showToast({title:"注册成功",icon:"none"})},fail:o=>{e.index.hideLoading(),e.index.showToast({title:"注册失败",icon:"none"})}})}})}})},tester(){console.log("target tester!")}}};var i=e._export_sfc(o,[["render",function(o,i,n,t,s,r){return{a:e.f(s.swiperList,((e,o,i)=>({a:e,b:o}))),b:e.o(((...e)=>r.login&&r.login(...e))),c:e.o(((...e)=>r.register&&r.register(...e)))}}]]);wx.createPage(i);
