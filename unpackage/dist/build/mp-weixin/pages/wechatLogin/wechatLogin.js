"use strict";var e=require("../../common/vendor.js");const o={data:()=>({swiperList:["../../static/swiper/swiper2.png"]}),created(){console.log("create触发"),this.tester()},methods:{login(){e.index.getUserProfile({desc:"微信快捷登录",success:o=>{console.log("用户信息: "+JSON.stringify(o.userInfo));let n=o.userInfo;e.index.login({provider:"weixin",success:o=>{e.index.showLoading({title:"登陆中"});var i=o.code;console.log("用户code获取:"+JSON.stringify(o)),console.log("UserInfo:",JSON.stringify(n)),e.index.request({url:"https://www.lyhxxcx.cn/wxlogin",method:"POST",header:{"content-type":"application/json"},data:{code:i},success:o=>{if(console.log("登陆:"+JSON.stringify(o.data)),0==o.data.err_code){var n=o.data.data.token;e.index.setStorageSync("token",n),console.log("Token:"+n),e.index.hideLoading(),e.index.switchTab({url:"/pages/index/index",animationType:"pop-in",animationDuration:200})}else 40003==o.data.err_code?(e.index.hideLoading(),e.index.showToast({title:"登陆失败-请先注册",icon:"none",duration:2e3})):(e.index.hideLoading(),e.index.showToast({title:"登陆失败-可能是网络问题",icon:"none",duration:2e3}))},fail:o=>{console.log("访问后端地址错误:"+o.errMsg),e.index.hideLoading(),e.index.showToast({title:"登陆失败",icon:"none",duration:2e3})}})}})}})},register(){e.index.getUserProfile({desc:"第一次使用自动注册",success:o=>{console.log("用户信息: "+JSON.stringify(o.userInfo));let n=o.userInfo;e.index.login({provider:"weixin",success:o=>{e.index.showLoading({title:"注册中"});var i=o.code;console.log("用户code获取成功:"+JSON.stringify(o)),console.log("UserInfo:",JSON.stringify(n)),e.index.request({url:"https://www.lyhxxcx.cn/wxregister",method:"POST",header:{"content-type":"application/json"},data:{code:i,username:n.nickName,sex:0==n.gender?"男":"女",avatarUrl:n.avatarUrl},success:o=>{console.log("注册:"+JSON.stringify(o.data)),e.index.hideLoading(),e.index.showToast({title:"注册成功",icon:"none"})},fail:o=>{console.log("注册 后端错误:"+o.errMsg),e.index.hideLoading(),e.index.showToast({title:"注册失败",icon:"none"})}})}})}})},tester(){console.log("target tester!")}}};var n=e._export_sfc(o,[["render",function(o,n,i,s,t,r){return{a:e.f(t.swiperList,((e,o,n)=>({a:e,b:o}))),b:e.o(((...e)=>r.login&&r.login(...e))),c:e.o(((...e)=>r.register&&r.register(...e)))}}]]);wx.createPage(n);
