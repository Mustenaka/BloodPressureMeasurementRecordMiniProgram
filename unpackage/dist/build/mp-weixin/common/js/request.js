"use strict";var e=require("../vendor.js");function t(){e.index.showModal({title:"登录提示",content:"身份已过期，请重新登录后再来操作！",success:t=>{t.confirm&&e.index.redirectTo({url:"/pages/wechatLogin/wechatLogin"})},fail(t){e.index.showToast({title:"未登录",icon:"none"})}})}var n={sendRequest:(n,o="GET",r={},a="application/json")=>{var i=e.index.getStorageSync("token");if(null==i||""==i)throw t(),new Error("无法操作 - 因为没有登录");var s="Bearer "+i||"";return console.log("Get Token Information: "+s),new Promise((function(i,c){e.index.request({url:"https://www.lyhxxcx.cn/"+n,data:r,method:o,header:{"Content-Type":a,Accept:"*/*",Authorization:s},success(n){var o=n.header.authorization||n.header.Authorization;switch(o&&e.index.setStorageSync("token",o),n.statusCode){case 401:t();break;case 404:e.index.showToast({title:"服务器资源错误 - 404",icon:"none",duration:2e3});break;default:i(n)}},fail(e){c(e)}})}))}};exports.http=n;
